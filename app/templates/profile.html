{% extends 'base.html' %}

{% block content %}
<div class="profile__cont">
    <div class="profile-container center">
        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="profile_tabs">
            <button class="profile_tab-button active" onclick="showTab('about')">–ü—Ä–æ—Ñ–∏–ª—å</button>
            <button class="profile_tab-button" onclick="showTab('booklists')">–°–ø–∏—Å–∫–∏ –∫–Ω–∏–≥</button>
        </div>

        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–æ–∫ -->
        <div id="about" class="profile_tab-content active">
            <h3 class="profile_tab-title">–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h3>
            <div class="profile_tab-content active">
                <h3 class="profile_tab-title">–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h3>
                <!-- –§–æ—Ä–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                <form action="{{ url_for ('update_profile') }}" method="POST" enctype="multipart/form-data"> <!-- –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ enctype -->
                    <div class="profile_form-group">
                        <label for="name" class="profile_tab-item">–ò–º—è:</label>
                        <input type="text" id="name" name="name" value="{{ current_user.name }}" class="profile_input">
                    </div>
                    <div class="profile_form-group">
                        <label for="email" class="profile_tab-item">Email:</label>
                        <input type="email" id="email" name="email" value="{{ current_user.email }}" class="profile_input">
                    </div>
                    <div class="profile_form-group">
                        <label for="username" class="profile_tab-item">–õ–æ–≥–∏–Ω:</label>
                        <input type="text" id="username" name="username" value="{{ current_user.username }}"
                               class="profile_input">
                    </div>
                    <div class="profile_form-group">
                        <label for="about_me" class="profile_tab-item">–û —Å–µ–±–µ:</label>
                        <textarea id="about_me" name="about_me" class="profile_input">{{ current_user.about_me }}</textarea>
                    </div>
                    <!-- –ü–æ–ª–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∫–∏ -->
                    <form action="{{ url_for('update_profile') }}" method="post" enctype="multipart/form-data">
                        <input type="file" name="avatar">
                        <button type="submit">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</button>
                    </form>
                    <button type="submit" class="profile_button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                </form>
            </div>

        <div id="booklists" class="profile_tab-content">
            <h2 class="book__title">–°–ø–∏—Å–∫–∏ –∫–Ω–∏–≥</h2>
            <div class="book-lists-display">
                {% for list in all_lists %}
                <div>
                    <div class="list-display-item">
                        <a href="{{ url_for('my_books', list_id=list.id) }}" class="profile_list">
                            <img src="{{ first_book.cover_image if first_book and first_book.cover_image else url_for('static', filename='image/no_cover.jpg') }}"
                                 alt="–û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ {{ list.name }}">
                            <h4>{{ list.name }} ({{ list.books.all()|length }})</h4>
                        </a>

                        <span class="edit-list" onclick="editList('{{ list.id }}{{ list.name }}')">üñã</span>
                        <form method="post" action="/delete_list/{{ list.id }}"
                              onsubmit="return openConfirmationModal(event)">
                            <button type="submit">‚ùå</button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
            <button onclick="createNewList(event)" class="profile_button">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–ø–∏—Å–æ–∫</button>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ -->
        <div id="createListModal" class="modal">
            <div class="modal-content">
                <h2 class="profile_tab-title">–°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫</h2>
                <form id="createListForm" action="/update_list" method="post">
                    <label for="list_name" class="profile_tab-item">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="list_name" name="list_name" class="profile_input">
                    <button type="submit" class="profile_button">–°–æ–∑–¥–∞—Ç—å</button>
                </form>

            </div>
            <span class="close-btn">&times;</span>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ -->
    <div id="editListModal" class="modal">
        <div class="modal-content">
            <h2 class="profile_tab-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫</h2>
            <form id="editListForm">
                <label for="editListName" class="profile_tab-item">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞:</label>
                <input type="text" id="editListName" name="editListName" class="profile_input">
                <button type="submit" class="profile_button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </form>
        </div>
        <span class="close-btn">&times;</span>
    </div>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ -->
    <div id="confirmDeleteModal" class="modal">
        <div class="modal-content">
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫?</p>
            <button id="confirmDeleteButton" class="profile_button">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            <button id="cancelDeleteButton" class="profile_button">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ -->
    <div id="updateListModal" class="modal">
        <div class="modal-content">
            <p>–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞:</p>
            <input id="newListName" type="text">
            <button id="confirmCreateButton" class="profile_button">–°–æ–∑–¥–∞—Ç—å</button>
            <button id="cancelCreateButton" class="profile_button">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>
</div>


<!--  –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∫–ª–∞–¥–∫–∞–º–∏ -->
<script src="/static/js/showTab.js"></script>
<!--  –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞–º–∏ -->
<script src="/static/js/my_lists.js"></script>

{% endblock %}
