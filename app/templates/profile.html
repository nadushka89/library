{% extends 'base.html' %} {% block content %}
<div class="profile__cont">
  <div class="profile-container center">
    <!-- –í–∫–ª–∞–¥–∫–∏ -->
    <div class="profile_tabs">
      <button class="profile_tab-button active" onclick="showTab('about')">–ü—Ä–æ—Ñ–∏–ª—å</button>
      <button class="profile_tab-button" onclick="showTab('changePassword')">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
      <button class="profile_tab-button" onclick="showTab('booklists')">–°–ø–∏—Å–∫–∏ –∫–Ω–∏–≥</button>
      
    </div>

    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–æ–∫ -->
    <div id="about" class="profile_tab-content active">
        <!-- –§–æ—Ä–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <form action="{{ url_for ('update_profile') }}" method="POST" enctype="multipart/form-data" class="profile_tab-content_left">
          <h3 class="profile_tab-title">–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h3>
          <div class="profile_form-group">
            <label for="name" class="profile_tab-item">–ò–º—è:</label>
            <input type="text" id="name" name="name" value="{{ current_user.name }}" class="profile_input" />
          </div>
          <div class="profile_form-group">
            <label for="email" class="profile_tab-item">Email:</label>
            <input type="email" id="email" name="email" value="{{ current_user.email }}" class="profile_input" />
          </div>
          <div class="profile_form-group">
            <label for="username" class="profile_tab-item">–õ–æ–≥–∏–Ω:</label>
            <input type="text" id="username" name="username" value="{{ current_user.username }}" class="profile_input" />
          </div>
          <div class="profile_form-group">
            <label for="about_me" class="profile_tab-item">–û —Å–µ–±–µ:</label>
            <textarea id="about_me" name="about_me" class="profile_input">{{ current_user.about_me }}</textarea>
          </div>
          
          <!-- –ü–æ–ª–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∫–∏ -->
          <div class="profile_form-group">
            <label for="avatar" class="profile_tab-item">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª</label>
            <input type="file" id="avatar" name="avatar" class="profile_input" />
          </div>
          <button type="submit" class="profile_button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
        </form>
        <div>
          <img src="{{ current_user.avatar_url }}" alt="–ê–≤–∞—Ç–∞—Ä" class="profile_tab-img" />
        </div>
      </div>

    <div id="booklists" class="profile_tab-content">
      <div class="book-lists-display">
        <h3 class="profile_tab-title">–°–ø–∏—Å–∫–∏ –∫–Ω–∏–≥</h3>
        {% for list in all_lists %}
        <div>
          <div class="list-display-item">
            <a href="{{ url_for('my_books', list_id=list.id) }}" class="profile_list">
              <img src="{{ first_book.cover_image if first_book and first_book.cover_image else url_for('static', filename='image/no_cover.jpg') }}" alt="–û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ {{ list.name }}" />
              <h5>{{ list.name }} ({{ list.books.all()|length }})</h4>
            </a>

            <span class="edit-list" onclick="editList('{{ list.id }}', '{{ list.name }}')">üñã</span>
            <form method="post" action="/delete_list/{{ list.id }}" onsubmit="return openConfirmationModal(event)">
              <button type="submit">‚ùå</button>
            </form>
          </div>
        </div>
        {% endfor %}
        
        <button onclick="createNewList(event)" class="profile_button">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–ø–∏—Å–æ–∫</button>
      </div>
    </div>
    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ "–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å" -->
    <div id="changePassword" class="profile_tab-content">
        <!-- –§–æ—Ä–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è -->
        <form action="{{ url_for('change_password') }}" method="POST" class="profile_tab-content_left">
            <h3 class="profile_tab-title">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h3>
            <div class="profile_form-group">
                <label for="old_password" class="profile_tab-item">–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å:</label>
                <input type="password" id="old_password" name="old_password" class="profile_input" required />
            </div>
            <div class="profile_form-group">
                <label for="new_password" class="profile_tab-item">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å:</label>
                <input type="password" id="new_password" name="new_password" class="profile_input" required />
            </div>
            <div class="profile_form-group">
                <label for="confirm_new_password" class="profile_tab-item">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å:</label>
                <input type="password" id="confirm_new_password" name="confirm_new_password" class="profile_input" required />
            </div>
            <button type="submit" class="profile_button">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
        </form>
    </div>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ -->
    <div id="createListModal" class="modal">
      <div class="modal-content">
        <h3 class="profile_tab-title">–°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫</h3>
        <form id="createListForm" action="/update_list" method="post">
          <label for="list_name" class="profile_tab-item">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
          <input type="text" id="list_name" name="list_name" class="profile_input" />
          <button type="submit" class="profile_button">–°–æ–∑–¥–∞—Ç—å</button>
        </form>
      </div>
      <span class="close-btn">&times;</span>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ -->
  <div id="editListModal" class="modal">
    <div class="modal-content">
      <h3 class="profile_tab-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫</h3>
      <form id="editListForm">
        <label for="editListName" class="profile_tab-item">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞:</label>
        <input type="text" id="editListName" name="editListName" class="profile_input" />
        <button type="submit" id="saveEditListButton" class="profile_button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
      </form>
    </div>
    <span class="close-btn">&times;</span>
  </div>
  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ -->
  <div id="confirmDeleteModal" class="modal">
    <div class="modal-content">
      <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫?</p>
      <button id="confirmDeleteButton" class="profile_button">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      <button id="cancelDeleteButton" class="profile_button">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div>
  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ -->
  <div id="updateListModal" class="modal">
    <div class="modal-content">
      <p>–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞:</p>
      <input id="newListName" type="text" />
      <button id="confirmCreateButton" class="profile_button">–°–æ–∑–¥–∞—Ç—å</button>
      <button id="cancelCreateButton" class="profile_button">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div>
</div>


<!--  –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∫–ª–∞–¥–∫–∞–º–∏ -->
<script src="/static/js/showTab.js"></script>
<!--  –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞–º–∏ -->
<script src="/static/js/my_lists.js"></script>

{% endblock %}
